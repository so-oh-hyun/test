6.2.1 ì‚¬ì´ë“œë°” ë§Œë“¤ê¸°

<ì½”ë“œ> ch06_chatbot.py ------------------------------------------------------------------------
import streamlit as st

# 1) main() í•¨ìˆ˜ ì„ ì–¸ 
def main():
    # 2) ë©”ì¸ í™”ë©´ êµ¬ì„± 
    st.set_page_config(layout="wide")
    st.title("ì¹œê·¼í•œ AI ì±—ë´‡")
    st.caption("ìŠ¤íŠ¸ë¦¼ê³¼ OpenAI APIë¥¼ í™œìš©í•œ ê°„ë‹¨í•œ ì±—ë´‡")
    # 3) ì‚¬ì´ë“œë°” êµ¬ì„± 
    with st.sidebar:
        st.subheader("OpenAI API Key ì„¤ì •")
        # 4) ì…ë ¥ ìœ„ì ¯ ìœ í˜• ì„¤ì •(ë¹„ë°€ë²ˆí˜¸)
        openai_api_key = st.text_input("OpenAI API Key", type="password")
        st.write("[OpenAI API Keyë°›ê¸°](https://platform.openai.com/account/api-keys)")

# 5) main() í•¨ìˆ˜ ì‹¤í–‰ 
if __name__ == "__main__":
    main()
</ì½”ë“œ> ------------------------------------------------------------------------------------------
â€ƒ
6.2.2 ì…ë ¥ì°½ ë° ëŒ€í™”ì°½ ë§Œë“¤ê¸° 

<ì½”ë“œ> ch06_chatbot.py -------------------------------------------------------------------------
import streamlit as st
# 1) main() í•¨ìˆ˜ ì„ ì–¸ 
def main():
    # 2) ë©”ì¸ í™”ë©´ êµ¬ì„± 
    st.set_page_config(layout="wide")
    st.title("ì¹œê·¼í•œ AI ì±—ë´‡")
    st.caption("ìŠ¤íŠ¸ë¦¼ê³¼ OpenAI APIë¥¼ í™œìš©í•œ ê°„ë‹¨í•œ ì±—ë´‡")
    # 3) ì‚¬ì´ë“œë°” êµ¬ì„± 
    with st.sidebar:
        st.subheader("OpenAI API Key ì„¤ì •")
        # 4) ì…ë ¥ ìœ„ì ¯ ìœ í˜• ì„¤ì •(ë¹„ë°€ë²ˆí˜¸)
        openai_api_key = st.text_input("OpenAI API Key", type="password")
        st.write("[OpenAI API Keyë°›ê¸°](https://platform.openai.com/account/api-keys)")
    # 6) ì…ë ¥ì°½ ë° ëŒ€í™”ì°½ êµ¬í˜„ 
    user_input = st.chat_input("ë¬´ì—‡ì´ ê¶ê¸ˆí•œê°€ìš”?")
    if user_input:
        # 7) ì‚¬ìš©ì ì§ˆë¬¸ ì¶œë ¥ 
        with st.chat_message("user"):
            st.write(user_input)
        # 8) ì±—ë´‡ ì‘ë‹µ ì¶œë ¥ 
        with st.chat_message("assistant"):
            st.write("ì•ˆë…•! ë‚œ ì¹œêµ¬ ë´‡ì´ì•¼.ğŸ˜Š")

# 5) main() í•¨ìˆ˜ ì‹¤í–‰
if __name__ == "__main__":
    main()
</ì½”ë“œ> ------------------------------------------------------------------------------------------

6.2.3 OpenAI APIë¡œ ìš”ì²­ ë° ì‘ë‹µ ì²˜ë¦¬í•˜ê¸°

<ì½”ë“œ> ch06_chatbot.py -------------------------------------------------------------------------
import streamlit as st
from openai import OpenAI # 9) openai íŒ¨í‚¤ì§€ì—ì„œ OpenAI í´ë˜ìŠ¤ ë¶ˆëŸ¬ì˜¤ê¸°

# 1) main() í•¨ìˆ˜ ì„ ì–¸
def main():
    # 2) ë©”ì¸ í™”ë©´ êµ¬ì„±
    st.set_page_config(layout="wide")
    st.title("ì¹œê·¼í•œ AI ì±—ë´‡")
    st.caption("ìŠ¤íŠ¸ë¦¼ë¦¿ê³¼ OpenAI APIë¥¼ í™œìš©í•œ ê°„ë‹¨í•œ ì±—ë´‡")
    # 3) ì‚¬ì´ë“œë°” êµ¬ì„±
    with st.sidebar:
        st.subheader("OpenAI API Key ì„¤ì •")
        # 4) ì…ë ¥ ìœ„ì ¯ ìœ í˜• ì„¤ì •(ë¹„ë°€ë²ˆí˜¸)
        openai_api_key = st.text_input("OpenAI API Key", type="password")
        st.write("[OpenAI API Keyë°›ê¸°](https://platform.openai.com/account/api-keys)")
    # 10) OpenAI í´ë¼ì´ì–¸íŠ¸ ìƒì„±
    client = OpenAI(api_key=openai_api_key)
    # 6) ì…ë ¥ì°½ ë° ëŒ€í™”ì°½ êµ¬í˜„
    user_input = st.chat_input("ë¬´ì—‡ì´ ê¶ê¸ˆí•œê°€ìš”?")
    if user_input:
        # 7) ì‚¬ìš©ì ì§ˆë¬¸ ì¶œë ¥
        with st.chat_message("user"):
            st.write(user_input)
        # 11) API ìš”ì²­ ë° ì‘ë‹µ(ê¸°ì¡´ 8)ë²ˆ ì½”ë“œ ì§€ìš°ê³  ì‘ì„±)
        with st.chat_message("assistant"):
            response = client.chat.completions.create(
                model="gpt-4o-mini",
                messages=[{"role": "assistant", "content": user_input}],
                stream=True,
            )
            # 12) ì‘ë‹µ ê²°ê³¼ ì¶œë ¥
            st.write_stream(response)

# 5) main() í•¨ìˆ˜ ì‹¤í–‰ 
if __name__ == "__main__":
    main()
</ì½”ë“œ> ------------------------------------------------------------------------------------------
â€ƒ
6.2.4 ê³¼ê±° ëŒ€í™” ë‚´ì—­ ê´€ë¦¬í•˜ê¸°

<ì½”ë“œ> ch06_chatbot.py -------------------------------------------------------------------------
import streamlit as st
from openai import OpenAI # 9) openai íŒ¨í‚¤ì§€ì—ì„œ OpenAI í´ë˜ìŠ¤ ë¶ˆëŸ¬ì˜¤ê¸°

# 1) main() í•¨ìˆ˜ ì„ ì–¸
def main():
    # 2) ë©”ì¸ í™”ë©´ êµ¬ì„±
    st.set_page_config(layout="wide")
    st.title("ì¹œê·¼í•œ AI ì±—ë´‡")
    st.caption("ìŠ¤íŠ¸ë¦¼ë¦¿ê³¼ OpenAI APIë¥¼ í™œìš©í•œ ê°„ë‹¨í•œ ì±—ë´‡")
    # 3) ì‚¬ì´ë“œë°” êµ¬ì„±
    with st.sidebar:
        st.subheader("OpenAI API Key ì„¤ì •")
        # 4) ì…ë ¥ ìœ„ì ¯ ìœ í˜• ì„¤ì •(ë¹„ë°€ë²ˆí˜¸)
        openai_api_key = st.text_input("OpenAI API Key", type="password")
        st.write("[OpenAI API Keyë°›ê¸°](https://platform.openai.com/account/api-keys)")
    # 13) ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ ì¶”ê°€
    system_message = """ë„ˆì˜ ì´ë¦„ì€ ì¹œêµ¬ ë´‡ì´ì•¼.
ë„ˆëŠ” í•­ìƒ ë°˜ë§ì„ í•˜ëŠ” ì±—ë´‡ì´ì•¼. ì ˆëŒ€ë¡œ ë‹¤ë‚˜ê¹Œ ê°™ì€ ë†’ì„ë§ë¡œ ëë‚´ì§€ ë§ˆ.
í•­ìƒ ë°˜ë§ë¡œ ì¹œê·¼í•˜ê²Œ ëŒ€ë‹µí•´ì¤˜.
ì˜ì–´ë¡œ ì§ˆë¬¸ì„ ë°›ì•„ë„ ë¬´ì¡°ê±´ í•œê¸€ë¡œ ë‹µë³€í•´ì¤˜.
í•œê¸€ì´ ì•„ë‹Œ ë‹µë³€ì„ í•˜ê²Œ ë˜ë©´ ë‹¤ì‹œ ìƒê°í•´ì„œ ë‹µë³€ì„ ê¼­ í•œê¸€ë¡œ ë§Œë“¤ì–´ì¤˜.
ëª¨ë“  ë‹µë³€ ëì— ë‹µë³€ì— ë§ëŠ” ì´ëª¨í‹°ì½˜ë„ ì¶”ê°€í•´ì¤˜.
"""
    # 14) ëŒ€í™” ë‚´ìš© ê´€ë¦¬ë¥¼ ìœ„í•œ ì„¸ì…˜ ìƒíƒœ ì„¤ì •
    if "messages" not in st.session_state:
        st.session_state.messages = [{"role": "system", "content": system_message}]
    # 15) ê¸°ì¡´ ëŒ€í™” ë‚´ì—­ í‘œì‹œ
    idx = 0 # ëŒ€í™” ë‚´ì—­ ìˆœë²ˆ ê¸°ë¡ìš© 
    for message in st.session_state.messages:
        if idx > 0:  # ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ëŠ” í‘œì‹œí•˜ì§€ ì•ŠìŒ
            with st.chat_message(message["role"]):
                st.write(message["content"])
        idx = idx + 1
    # 10) OpenAI í´ë¼ì´ì–¸íŠ¸ ìƒì„±
    client = OpenAI(api_key=openai_api_key)
    # 6) ì…ë ¥ì°½ ë° ëŒ€í™”ì°½ êµ¬í˜„
    user_input = st.chat_input("ë¬´ì—‡ì´ ê¶ê¸ˆí•œê°€ìš”?")
    if user_input:
        # 16) ì„¸ì…˜ ìƒíƒœ ë¦¬ìŠ¤íŠ¸ì— ì‚¬ìš©ì ì§ˆë¬¸ ì¶”ê°€ 
        st.session_state.messages.append({"role": "user", "content": user_input})
        # 7) ì‚¬ìš©ì ì§ˆë¬¸ ì¶œë ¥
        with st.chat_message("user"):
            st.write(user_input)
        # 17) API ìš”ì²­ ë° ì‘ë‹µ(ê¸°ì¡´ 11)~12)ë²ˆ ì½”ë“œ ì§€ìš°ê³  ì‘ì„±)
        with st.chat_message("assistant"):
            stream = client.chat.completions.create(
                model="gpt-4o-mini",
                messages=st.session_state.messages,
                stream=True,
            )
            response = st.write_stream(stream)
        # 18) ì„¸ì…˜ ìƒíƒœ ë¦¬ìŠ¤íŠ¸ì— ì±—ë´‡ ì‘ë‹µ ì¶”ê°€
        st.session_state.messages.append({"role": "assistant", "content": response})

# 5) main() í•¨ìˆ˜ ì‹¤í–‰ 
if __name__ == "__main__":
    main()
</ì½”ë“œ> ------------------------------------------------------------------------------------------
